<div class="ajustes-wrapper container-fluid bg-white py-4">
  <div class="ajustes-card container">
    <!-- Header -->
    <div class="ajustes-header text-center mb-4">
      <h1 class="ajustes-title">
        <span class="icon">丘뙖잺</span> Ajustes de Seguridad
      </h1>
      <p class="ajustes-subtitle">Gestiona tu correo electr칩nico y contrase침a de forma segura</p>
    </div>

    <!-- Grid horizontal 50/50 -->
    <div class="row gx-4">
      <!-- Actualizar correo -->
      <div class="col-md-6">
        <div class="ajustes-section" [class.loading]="loadingEmail">
          <h2 class="section-title mb-3">
            <span class="icon">游닎</span> Actualizar Correo
          </h2>
          <form [formGroup]="emailForm" (ngSubmit)="submitEmail()" class="ajustes-form" novalidate>
            <div class="form-group mb-3"
                 [class.has-error]="emailForm.get('email')?.invalid && (emailForm.get('email')?.touched || emailForm.get('email')?.dirty)">
              <label for="email">NUEVO CORREO ELECTR칍NICO</label>
              <input id="email" type="email" formControlName="email" placeholder="ejemplo@correo.com" autocomplete="email" />
              <div *ngIf="emailForm.get('email')?.invalid && (emailForm.get('email')?.touched || emailForm.get('email')?.dirty)" class="error-text">
                <span *ngIf="emailForm.get('email')?.errors?.['required']">El correo es obligatorio</span>
                <span *ngIf="emailForm.get('email')?.errors?.['email']">Formato de correo inv치lido</span>
              </div>
            </div>
            <div class="text-end">
              <button type="submit" class="btn btn-primary" [disabled]="loadingEmail || emailForm.invalid">
                <span *ngIf="!loadingEmail">Actualizar Correo</span>
                <span *ngIf="loadingEmail" class="loading-spinner"></span>
              </button>
            </div>
          </form>
        </div>
      </div>

      <!-- Cambiar contrase침a -->
      <div class="col-md-6">
        <div class="ajustes-section" [class.loading]="loadingPassword">
          <h2 class="section-title mb-3">
            <span class="icon">游댐</span> Cambiar Contrase침a
          </h2>
          <form [formGroup]="passwordForm" (ngSubmit)="submitPassword()" class="ajustes-form" novalidate>
            <div class="form-group mb-3"
                 [class.has-error]="passwordForm.get('passwordNew')?.invalid && (passwordForm.get('passwordNew')?.touched || passwordForm.get('passwordNew')?.dirty)">
              <label for="passwordNew">NUEVA CONTRASE칌A</label>
              <input id="passwordNew" type="password" formControlName="passwordNew" placeholder="M칤nimo 8 caracteres, una may칰scula y un car치cter especial" autocomplete="new-password" />
              <div *ngIf="passwordForm.get('passwordNew')?.invalid && (passwordForm.get('passwordNew')?.touched || passwordForm.get('passwordNew')?.dirty)" class="error-text">
                <span *ngIf="passwordForm.get('passwordNew')?.errors?.['required']">La contrase침a es obligatoria</span>
                <span *ngIf="passwordForm.get('passwordNew')?.errors?.['minlength']">Debe tener al menos 8 caracteres</span>
                <span *ngIf="passwordForm.get('passwordNew')?.errors?.['pattern']">Debe incluir al menos una may칰scula y un car치cter especial</span>
              </div>
            </div>

            <div class="form-group mb-3"
                 [class.has-error]="passwordForm.get('passwordConfirm')?.invalid && (passwordForm.get('passwordConfirm')?.touched || passwordForm.get('passwordConfirm')?.dirty)">
              <label for="passwordConfirm">CONFIRMAR CONTRASE칌A</label>
              <input id="passwordConfirm" type="password" formControlName="passwordConfirm" placeholder="Repite la contrase침a" autocomplete="new-password" />
              <div *ngIf="passwordForm.get('passwordConfirm')?.invalid && (passwordForm.get('passwordConfirm')?.touched || passwordForm.get('passwordConfirm')?.dirty)" class="error-text">
                <span *ngIf="passwordForm.get('passwordConfirm')?.errors?.['required']">La confirmaci칩n es obligatoria</span>
              </div>
            </div>

            <div *ngIf="passwordForm.errors?.['mismatch'] && (passwordForm.get('passwordNew')?.touched || passwordForm.get('passwordConfirm')?.touched)" class="error-text">
              Las contrase침as no coinciden
            </div>

            <div class="text-end">
              <button type="submit" class="btn btn-primary" [disabled]="loadingPassword || passwordForm.invalid">
                <span *ngIf="!loadingPassword">Cambiar Contrase침a</span>
                <span *ngIf="loadingPassword" class="loading-spinner"></span>
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>
