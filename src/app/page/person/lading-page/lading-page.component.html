<header tuiHeader>
  <h1 tuiTitle>
    Todos <span class="count">{{ persons?.length }} personas</span>
  </h1>
  <aside tuiAccessories>
    <div tuiAppearance="secondary" tuiButtonGroup>
      <a class="btn-add" routerLink="/dashboard/person/crear">
        <mat-icon>add_circle</mat-icon>
        Crear persona
      </a>
    </div>
  </aside>
</header>

<section class="table-container">
  <!-- Tabs -->
  <div class="tabs">
    <button class="active">Activos</button>
    <button>Inactivos</button>
  </div>

  <!-- Buscador y filtro -->
  <div class="actions">
    <div class="search-box">
      <mat-icon>search</mat-icon>
      <input
        #searchInput
        type="text"
        placeholder="Buscar..."
        (input)="onSearch(searchInput.value)"
      />
    </div>
    <button class="filter-btn">
      <mat-icon>filter_list</mat-icon> Filter
    </button>
  </div>

  <!-- Tabla -->
  <table class="custom-table">
    <thead>
      <tr>
        <th>#</th>
        <th>Primer nombre</th>
        <th>Segundo nombre</th>
        <th>Primer apellido</th>
        <th>Segundo apellido</th>
        <th>Identificación</th>
        <th>Teléfono</th>
        <th>Status</th>
        <th>Acción</th>
      </tr>
    </thead>
    <tbody>
      @for (item of paginatedPersons; track $index) {
      <tr>
        <td>{{ ($index + 1) + (currentPage - 1) * pageSize }}</td>
        <td>{{ item.fisrtName }}</td>
        <td>{{ item.secondName }}</td>
        <td>{{ item.lastName }}</td>
        <td>{{ item.secondLastName }}</td>
        <td>{{ item.identification }}</td>
        <td>{{ item.phone }}</td>
        <td>
          <mat-slide-toggle
            [checked]="item.status === 1"
            (change)="logical($event, item.id)"
          ></mat-slide-toggle>
        </td>
        <td class="actions-col">
          <a mat-icon-button routerLink="/dashboard/person/editar/{{ item.id }}">
            <mat-icon>edit</mat-icon>
          </a>
          <button
            mat-icon-button
            [swal]="{
              title: 'Confirmacion',
              text: '¿Deseas borrar este registro?',
              showCancelButton: true
            }"
            (confirm)="deleteRegister(item.id)"
          >
            <mat-icon>delete</mat-icon>
          </button>
        </td>
      </tr>
      }
    </tbody>
  </table>

  <!-- Paginación -->
  <div class="pagination" *ngIf="totalPages > 1">
    <button (click)="changePage(currentPage - 1)" [disabled]="currentPage === 1">
      &lt;
    </button>

    <button
      *ngFor="let page of [].constructor(totalPages); let i = index"
      (click)="changePage(i + 1)"
      [class.active]="currentPage === i + 1"
    >
      {{ i + 1 }}
    </button>

    <button
      (click)="changePage(currentPage + 1)"
      [disabled]="currentPage === totalPages"
    >
      &gt;
    </button>
  </div>
</section>
